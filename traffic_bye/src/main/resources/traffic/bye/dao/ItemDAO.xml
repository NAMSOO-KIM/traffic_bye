<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="traffic.bye.dao.ItemDAO">

	
	<select id="getItemList" resultType="ItemVO">
	<![CDATA[
		select *
		from item i
	]]>
	</select>
	
	<select id="getItem" parameterType="long" resultType="ItemVO">
	<![CDATA[
		select it.id, it.CATEGORY_ID, it.NAME, it.STOCK, it.PRICE, it.DETAIL, it.STORE_ID, im.UPLOAD_FILE_NAME, im.REAL_FILE_NAME
		from ITEM it
		inner join item_image im
		on it.ID=im.ITEM_ID
		where it.id = #{id}
	]]>
	</select>
	
	<parameterMap type="java.util.HashMap" id="selectRelatedMap">
		<parameter property="category_id" jdbcType="NUMERIC" mode="IN" />
		<parameter property="id" jdbcType="NUMERIC" mode="IN" />
	</parameterMap>
	<select id="getRelatedItemList" parameterMap="selectRelatedMap" resultType="ItemVO">
	<![CDATA[
		select it.id, it.CATEGORY_ID, it.NAME, it.STOCK, it.PRICE, it.DETAIL, it.STORE_ID, im.UPLOAD_FILE_NAME, im.REAL_FILE_NAME
		from ITEM it
		inner join item_image im
		on it.ID=im.ITEM_ID
		where it.category_id = #{category_id} and it.id != #{id}
	]]>
	</select>
	
	<select id="getMainCategoryItemList" parameterType="long" resultType="ItemVO">
	<![CDATA[
		SELECT *
		from item
		where category_id in 
				(
   				select id
   				from category
   				where parent_id = #{parent_id}
				)
		
	]]>
	</select>
	

	
</mapper>
